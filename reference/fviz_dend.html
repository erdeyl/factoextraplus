<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Enhanced Visualization of Dendrogram — fviz_dend • factoextraplus</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Enhanced Visualization of Dendrogram — fviz_dend"><meta name="description" content="Draws easily beautiful dendrograms using either R base plot or
  ggplot2. Provides also an option for drawing a circular dendrogram and
  phylogenic trees."><meta property="og:description" content="Draws easily beautiful dendrograms using either R base plot or
  ggplot2. Provides also an option for drawing a circular dendrogram and
  phylogenic trees."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">factoextraplus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/erdeyl/factoextraplus/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Enhanced Visualization of Dendrogram</h1>
      <small class="dont-index">Source: <a href="https://github.com/erdeyl/factoextraplus/blob/main/R/fviz_dend.R" class="external-link"><code>R/fviz_dend.R</code></a></small>
      <div class="d-none name"><code>fviz_dend.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Draws easily beautiful dendrograms using either R base plot or
  ggplot2. Provides also an option for drawing a circular dendrogram and
  phylogenic trees.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fviz_dend</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  k <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  h <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  k_colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  palette <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  show_labels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  color_labels_by_k <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  label_cols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  labels_track_height <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  repel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  lwd <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rectangle"</span>, <span class="st">"circular"</span>, <span class="st">"phylogenic"</span><span class="op">)</span>,</span>
<span>  phylo_layout <span class="op">=</span> <span class="st">"layout.auto"</span>,</span>
<span>  rect <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  rect_border <span class="op">=</span> <span class="st">"gray"</span>,</span>
<span>  rect_lty <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  rect_fill <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">lower_rect</span>,</span>
<span>  horiz <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Cluster Dendrogram"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">""</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Height"</span>,</span>
<span>  sub <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ggtheme <span class="op">=</span> <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>an object of class dendrogram, hclust, agnes, diana, hcut,
hkmeans or HCPC (FactoMineR).</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>the number of groups for cutting the tree.</p></dd>


<dt id="arg-h">h<a class="anchor" aria-label="anchor" href="#arg-h"></a></dt>
<dd><p>a numeric value. Cut the dendrogram by cutting at height h. (k
overrides h)</p></dd>


<dt id="arg-k-colors-palette">k_colors, palette<a class="anchor" aria-label="anchor" href="#arg-k-colors-palette"></a></dt>
<dd><p>a vector containing colors to be used for the groups.
It should contains k number of colors. Allowed values include also "grey"
for grey color palettes; brewer palettes e.g. "RdBu", "Blues", ...;  and
scientific journal palettes from ggsci R package, e.g.: "npg", "aaas",
"lancet", "jco", "ucscgb", "uchicago", "simpsons" and "rickandmorty".</p></dd>


<dt id="arg-show-labels">show_labels<a class="anchor" aria-label="anchor" href="#arg-show-labels"></a></dt>
<dd><p>a logical value. If TRUE, leaf labels are shown. Default
value is TRUE.</p></dd>


<dt id="arg-color-labels-by-k">color_labels_by_k<a class="anchor" aria-label="anchor" href="#arg-color-labels-by-k"></a></dt>
<dd><p>logical value. If TRUE, labels are colored
automatically by group when k != NULL.</p></dd>


<dt id="arg-label-cols">label_cols<a class="anchor" aria-label="anchor" href="#arg-label-cols"></a></dt>
<dd><p>a vector containing the colors for labels.</p></dd>


<dt id="arg-labels-track-height">labels_track_height<a class="anchor" aria-label="anchor" href="#arg-labels-track-height"></a></dt>
<dd><p>a positive numeric value for adjusting the room for the
labels. Used only when type = "rectangle".</p></dd>


<dt id="arg-repel">repel<a class="anchor" aria-label="anchor" href="#arg-repel"></a></dt>
<dd><p>logical value. Use repel = TRUE to avoid label overplotting when
type = "phylogenic".</p></dd>


<dt id="arg-lwd">lwd<a class="anchor" aria-label="anchor" href="#arg-lwd"></a></dt>
<dd><p>a numeric value specifying branches and rectangle line width.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>type of plot. Allowed values are one of "rectangle", "triangle",
"circular", "phylogenic".</p></dd>


<dt id="arg-phylo-layout">phylo_layout<a class="anchor" aria-label="anchor" href="#arg-phylo-layout"></a></dt>
<dd><p>the layout to be used for phylogenic trees. Default value
is "layout.auto". Allowed values include:
<code><a href="https://r.igraph.org/reference/layout.auto.html" class="external-link">layout.auto</a></code>, <code><a href="https://r.igraph.org/reference/layout_with_drl.html" class="external-link">layout_with_drl</a></code>,
<code><a href="https://r.igraph.org/reference/layout_as_tree.html" class="external-link">layout_as_tree</a></code>, <code><a href="https://r.igraph.org/reference/layout.gem.html" class="external-link">layout.gem</a></code>,
<code><a href="https://r.igraph.org/reference/layout.mds.html" class="external-link">layout.mds</a></code> and <code><a href="https://r.igraph.org/reference/layout_with_lgl.html" class="external-link">layout_with_lgl</a></code>.</p></dd>


<dt id="arg-rect">rect<a class="anchor" aria-label="anchor" href="#arg-rect"></a></dt>
<dd><p>logical value specifying whether to add a rectangle around
groups. Used only when k != NULL.</p></dd>


<dt id="arg-rect-border-rect-lty">rect_border, rect_lty<a class="anchor" aria-label="anchor" href="#arg-rect-border-rect-lty"></a></dt>
<dd><p>border color and line type for rectangles.</p></dd>


<dt id="arg-rect-fill">rect_fill<a class="anchor" aria-label="anchor" href="#arg-rect-fill"></a></dt>
<dd><p>a logical value. If TRUE, fill the rectangle.</p></dd>


<dt id="arg-lower-rect">lower_rect<a class="anchor" aria-label="anchor" href="#arg-lower-rect"></a></dt>
<dd><p>a value of how low should the lower part of the rectangle
around clusters. Ignored when rect = FALSE.</p></dd>


<dt id="arg-horiz">horiz<a class="anchor" aria-label="anchor" href="#arg-horiz"></a></dt>
<dd><p>a logical value. If TRUE, an horizontal dendrogram is drawn.</p></dd>


<dt id="arg-cex">cex<a class="anchor" aria-label="anchor" href="#arg-cex"></a></dt>
<dd><p>size of labels</p></dd>


<dt id="arg-main-xlab-ylab">main, xlab, ylab<a class="anchor" aria-label="anchor" href="#arg-main-xlab-ylab"></a></dt>
<dd><p>main and axis titles</p></dd>


<dt id="arg-sub">sub<a class="anchor" aria-label="anchor" href="#arg-sub"></a></dt>
<dd><p>Plot subtitle. If NULL, the method used hierarchical clustering is
shown. To remove the subtitle use sub = "".</p></dd>


<dt id="arg-ggtheme">ggtheme<a class="anchor" aria-label="anchor" href="#arg-ggtheme"></a></dt>
<dd><p>function, ggplot2 theme name. Default value is
theme_classic(). Allowed values include ggplot2 official themes:
theme_gray(), theme_bw(), theme_minimal(), theme_classic(), theme_void(),
....</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>other arguments to be passed to the function plot.dendrogram()</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>an object of class fviz_dend which is a ggplot with the attributes
  "dendrogram" accessible using attr(x, "dendrogram"), where x is the result
  of fviz_dend().</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Load and scale the data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">USArrests</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">USArrests</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Hierarchical clustering</span></span></span>
<span class="r-in"><span><span class="va">res.hc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="dist.html">dist</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Default plot</span></span></span>
<span class="r-in"><span><span class="fu">fviz_dend</span><span class="op">(</span><span class="va">res.hc</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fviz_dend-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Cut the tree</span></span></span>
<span class="r-in"><span><span class="fu">fviz_dend</span><span class="op">(</span><span class="va">res.hc</span>, cex <span class="op">=</span> <span class="fl">0.5</span>, k <span class="op">=</span> <span class="fl">4</span>, color_labels_by_k <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fviz_dend-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Don't color labels, add rectangles</span></span></span>
<span class="r-in"><span><span class="fu">fviz_dend</span><span class="op">(</span><span class="va">res.hc</span>, cex <span class="op">=</span> <span class="fl">0.5</span>, k <span class="op">=</span> <span class="fl">4</span>, </span></span>
<span class="r-in"><span> color_labels_by_k <span class="op">=</span> <span class="cn">FALSE</span>, rect <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fviz_dend-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># Change the color of tree using black color for all groups</span></span></span>
<span class="r-in"><span><span class="co"># Change rectangle border colors</span></span></span>
<span class="r-in"><span><span class="fu">fviz_dend</span><span class="op">(</span><span class="va">res.hc</span>, rect <span class="op">=</span> <span class="cn">TRUE</span>, k_colors <span class="op">=</span><span class="st">"black"</span>,</span></span>
<span class="r-in"><span>rect_border <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, rect_lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fviz_dend-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Customized color for groups</span></span></span>
<span class="r-in"><span><span class="fu">fviz_dend</span><span class="op">(</span><span class="va">res.hc</span>, k <span class="op">=</span> <span class="fl">4</span>, </span></span>
<span class="r-in"><span> k_colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#1B9E77"</span>, <span class="st">"#D95F02"</span>, <span class="st">"#7570B3"</span>, <span class="st">"#E7298A"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fviz_dend-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="co"># Color labels using k-means clusters</span></span></span>
<span class="r-in"><span> <span class="va">km.clust</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">4</span><span class="op">)</span><span class="op">$</span><span class="va">cluster</span></span></span>
<span class="r-in"><span> <span class="fu">fviz_dend</span><span class="op">(</span><span class="va">res.hc</span>, k <span class="op">=</span> <span class="fl">4</span>, </span></span>
<span class="r-in"><span>   k_colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"green3"</span>, <span class="st">"red"</span>, <span class="st">"black"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   label_cols <span class="op">=</span>  <span class="va">km.clust</span><span class="op">[</span><span class="va">res.hc</span><span class="op">$</span><span class="va">order</span><span class="op">]</span>, cex <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fviz_dend-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Laszlo Erdey, Alboukadel Kassambara, Fabian Mundt.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

