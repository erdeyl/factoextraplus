<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Enhanced Visualization of Dendrogram — fviz_dend • factoextraplus</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Enhanced Visualization of Dendrogram — fviz_dend"><meta property="og:description" content="Draws easily beautiful dendrograms using either R base plot or
  ggplot2. Provides also an option for drawing a circular dendrogram and
  phylogenic trees."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">factoextraplus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/erdeyl/factoextraplus/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Enhanced Visualization of Dendrogram</h1>
    <small class="dont-index">Source: <a href="https://github.com/erdeyl/factoextraplus/blob/HEAD/R/fviz_dend.R" class="external-link"><code>R/fviz_dend.R</code></a></small>
    <div class="hidden name"><code>fviz_dend.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Draws easily beautiful dendrograms using either R base plot or
  ggplot2. Provides also an option for drawing a circular dendrogram and
  phylogenic trees.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fviz_dend</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  k <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  h <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  k_colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  palette <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  show_labels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  color_labels_by_k <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  label_cols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  labels_track_height <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  repel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  lwd <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rectangle"</span>, <span class="st">"circular"</span>, <span class="st">"phylogenic"</span><span class="op">)</span>,</span>
<span>  phylo_layout <span class="op">=</span> <span class="st">"layout.auto"</span>,</span>
<span>  rect <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  rect_border <span class="op">=</span> <span class="st">"gray"</span>,</span>
<span>  rect_lty <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  rect_fill <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">lower_rect</span>,</span>
<span>  horiz <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Cluster Dendrogram"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">""</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Height"</span>,</span>
<span>  sub <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ggtheme <span class="op">=</span> <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>an object of class dendrogram, hclust, agnes, diana, hcut,
hkmeans or HCPC (FactoMineR).</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>the number of groups for cutting the tree.</p></dd>


<dt id="arg-h">h<a class="anchor" aria-label="anchor" href="#arg-h"></a></dt>
<dd><p>a numeric value. Cut the dendrogram by cutting at height h. (k
overrides h)</p></dd>


<dt id="arg-k-colors-palette">k_colors, palette<a class="anchor" aria-label="anchor" href="#arg-k-colors-palette"></a></dt>
<dd><p>a vector containing colors to be used for the groups.
It should contains k number of colors. Allowed values include also "grey"
for grey color palettes; brewer palettes e.g. "RdBu", "Blues", ...;  and
scientific journal palettes from ggsci R package, e.g.: "npg", "aaas",
"lancet", "jco", "ucscgb", "uchicago", "simpsons" and "rickandmorty".</p></dd>


<dt id="arg-show-labels">show_labels<a class="anchor" aria-label="anchor" href="#arg-show-labels"></a></dt>
<dd><p>a logical value. If TRUE, leaf labels are shown. Default
value is TRUE.</p></dd>


<dt id="arg-color-labels-by-k">color_labels_by_k<a class="anchor" aria-label="anchor" href="#arg-color-labels-by-k"></a></dt>
<dd><p>logical value. If TRUE, labels are colored
automatically by group when k != NULL.</p></dd>


<dt id="arg-label-cols">label_cols<a class="anchor" aria-label="anchor" href="#arg-label-cols"></a></dt>
<dd><p>a vector containing the colors for labels.</p></dd>


<dt id="arg-labels-track-height">labels_track_height<a class="anchor" aria-label="anchor" href="#arg-labels-track-height"></a></dt>
<dd><p>a positive numeric value for adjusting the room for the
labels. Used only when type = "rectangle".</p></dd>


<dt id="arg-repel">repel<a class="anchor" aria-label="anchor" href="#arg-repel"></a></dt>
<dd><p>logical value. Use repel = TRUE to avoid label overplotting when
type = "phylogenic".</p></dd>


<dt id="arg-lwd">lwd<a class="anchor" aria-label="anchor" href="#arg-lwd"></a></dt>
<dd><p>a numeric value specifying branches and rectangle line width.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>type of plot. Allowed values are one of "rectangle", "triangle",
"circular", "phylogenic".</p></dd>


<dt id="arg-phylo-layout">phylo_layout<a class="anchor" aria-label="anchor" href="#arg-phylo-layout"></a></dt>
<dd><p>the layout to be used for phylogenic trees. Default value
is "layout.auto". Allowed values include:
<code><a href="https://r.igraph.org/reference/layout.auto.html" class="external-link">layout.auto</a></code>, <code><a href="https://r.igraph.org/reference/layout_with_drl.html" class="external-link">layout_with_drl</a></code>,
<code><a href="https://r.igraph.org/reference/layout_as_tree.html" class="external-link">layout_as_tree</a></code>, <code><a href="https://r.igraph.org/reference/layout.gem.html" class="external-link">layout.gem</a></code>,
<code><a href="https://r.igraph.org/reference/layout.mds.html" class="external-link">layout.mds</a></code> and <code><a href="https://r.igraph.org/reference/layout_with_lgl.html" class="external-link">layout_with_lgl</a></code>.</p></dd>


<dt id="arg-rect">rect<a class="anchor" aria-label="anchor" href="#arg-rect"></a></dt>
<dd><p>logical value specifying whether to add a rectangle around
groups. Used only when k != NULL.</p></dd>


<dt id="arg-rect-border-rect-lty">rect_border, rect_lty<a class="anchor" aria-label="anchor" href="#arg-rect-border-rect-lty"></a></dt>
<dd><p>border color and line type for rectangles.</p></dd>


<dt id="arg-rect-fill">rect_fill<a class="anchor" aria-label="anchor" href="#arg-rect-fill"></a></dt>
<dd><p>a logical value. If TRUE, fill the rectangle.</p></dd>


<dt id="arg-lower-rect">lower_rect<a class="anchor" aria-label="anchor" href="#arg-lower-rect"></a></dt>
<dd><p>a value of how low should the lower part of the rectangle
around clusters. Ignored when rect = FALSE.</p></dd>


<dt id="arg-horiz">horiz<a class="anchor" aria-label="anchor" href="#arg-horiz"></a></dt>
<dd><p>a logical value. If TRUE, an horizontal dendrogram is drawn.</p></dd>


<dt id="arg-cex">cex<a class="anchor" aria-label="anchor" href="#arg-cex"></a></dt>
<dd><p>size of labels</p></dd>


<dt id="arg-main-xlab-ylab">main, xlab, ylab<a class="anchor" aria-label="anchor" href="#arg-main-xlab-ylab"></a></dt>
<dd><p>main and axis titles</p></dd>


<dt id="arg-sub">sub<a class="anchor" aria-label="anchor" href="#arg-sub"></a></dt>
<dd><p>Plot subtitle. If NULL, the method used hierarchical clustering is
shown. To remove the subtitle use sub = "".</p></dd>


<dt id="arg-ggtheme">ggtheme<a class="anchor" aria-label="anchor" href="#arg-ggtheme"></a></dt>
<dd><p>function, ggplot2 theme name. Default value is
theme_classic(). Allowed values include ggplot2 official themes:
theme_gray(), theme_bw(), theme_minimal(), theme_classic(), theme_void(),
....</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>other arguments to be passed to the function plot.dendrogram()</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>an object of class fviz_dend which is a ggplot with the attributes
  "dendrogram" accessible using attr(x, "dendrogram"), where x is the result
  of fviz_dend().</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Load and scale the data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">USArrests</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">USArrests</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Hierarchical clustering</span></span></span>
<span class="r-in"><span><span class="va">res.hc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="dist.html">dist</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Default plot</span></span></span>
<span class="r-in"><span><span class="fu">fviz_dend</span><span class="op">(</span><span class="va">res.hc</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fviz_dend-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Cut the tree</span></span></span>
<span class="r-in"><span><span class="fu">fviz_dend</span><span class="op">(</span><span class="va">res.hc</span>, cex <span class="op">=</span> <span class="fl">0.5</span>, k <span class="op">=</span> <span class="fl">4</span>, color_labels_by_k <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fviz_dend-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Don't color labels, add rectangles</span></span></span>
<span class="r-in"><span><span class="fu">fviz_dend</span><span class="op">(</span><span class="va">res.hc</span>, cex <span class="op">=</span> <span class="fl">0.5</span>, k <span class="op">=</span> <span class="fl">4</span>, </span></span>
<span class="r-in"><span> color_labels_by_k <span class="op">=</span> <span class="cn">FALSE</span>, rect <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fviz_dend-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># Change the color of tree using black color for all groups</span></span></span>
<span class="r-in"><span><span class="co"># Change rectangle border colors</span></span></span>
<span class="r-in"><span><span class="fu">fviz_dend</span><span class="op">(</span><span class="va">res.hc</span>, rect <span class="op">=</span> <span class="cn">TRUE</span>, k_colors <span class="op">=</span><span class="st">"black"</span>,</span></span>
<span class="r-in"><span>rect_border <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, rect_lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fviz_dend-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Customized color for groups</span></span></span>
<span class="r-in"><span><span class="fu">fviz_dend</span><span class="op">(</span><span class="va">res.hc</span>, k <span class="op">=</span> <span class="fl">4</span>, </span></span>
<span class="r-in"><span> k_colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#1B9E77"</span>, <span class="st">"#D95F02"</span>, <span class="st">"#7570B3"</span>, <span class="st">"#E7298A"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fviz_dend-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="co"># Color labels using k-means clusters</span></span></span>
<span class="r-in"><span> <span class="va">km.clust</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">4</span><span class="op">)</span><span class="op">$</span><span class="va">cluster</span></span></span>
<span class="r-in"><span> <span class="fu">fviz_dend</span><span class="op">(</span><span class="va">res.hc</span>, k <span class="op">=</span> <span class="fl">4</span>, </span></span>
<span class="r-in"><span>   k_colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"green3"</span>, <span class="st">"red"</span>, <span class="st">"black"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   label_cols <span class="op">=</span>  <span class="va">km.clust</span><span class="op">[</span><span class="va">res.hc</span><span class="op">$</span><span class="va">order</span><span class="op">]</span>, cex <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fviz_dend-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Laszlo Erdey, Alboukadel Kassambara, Fabian Mundt.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

